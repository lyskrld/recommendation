nohup: ignoring input
>>>>>>>>>>B-I statistics>>>>>>>>>>
Average interactions 37.02934265136719
Non-zero rows 1.0
Non-zero columns 0.8566981995727799
Matrix density 0.0011299769286862884
finish loading assist data
>>>>>>>>>>U-I statistics>>>>>>>>>>
Average interactions 17.230377197265625
Non-zero rows 0.9958950118173903
Non-zero columns 0.641867561794324
Matrix density 0.0005257972814327529
finish loading item data
>>>>>>>>>>U-B statistics in train>>>>>>>>>>
Average interactions 4.281129360198975
Non-zero rows 0.3680806070406767
Non-zero columns 0.8645986166422134
Matrix density 0.0008973233061660289
finish loading bundle train data
>>>>>>>>>>U-B statistics in test>>>>>>>>>>
Average interactions 1.2123398780822754
Non-zero rows 0.3680806070406767
Non-zero columns 0.5017815971494446
Matrix density 0.0002541060245785134
finish loading bundle test data
>>>>>>>>>>B-I statistics>>>>>>>>>>
Average interactions 37.02934265136719
Non-zero rows 1.0
Non-zero columns 0.8566981995727799
Matrix density 0.0011299769286862884
finish loading assist data
>>>>>>>>>>U-I statistics>>>>>>>>>>
Average interactions 17.230377197265625
Non-zero rows 0.9958950118173903
Non-zero columns 0.641867561794324
Matrix density 0.0005257972814327529
finish loading item data
>>>>>>>>>>U-B statistics in train>>>>>>>>>>
Average interactions 4.281129360198975
Non-zero rows 0.3680806070406767
Non-zero columns 0.8645986166422134
Matrix density 0.0008973233061660289
finish loading bundle train data
>>>>>>>>>>U-B statistics in test>>>>>>>>>>
Average interactions 0.6454783082008362
Non-zero rows 0.3680806070406767
Non-zero columns 0.34835464263257176
Matrix density 0.00013529203381263145
finish loading bundle test data
IHGCN model
/data/lzm/IHBR - 副本/model/IHGCN.py:169: UserWarning: Creating a tensor from a list of numpy.ndarrays is extremely slow. Please consider converting the list to a single numpy.ndarray with numpy.array() before converting to a tensor. (Triggered internally at  /opt/conda/conda-bld/pytorch_1640811805959/work/torch/csrc/utils/tensor_new.cpp:201.)
  ub_indices = torch.tensor([ub_graph_coo.row, ub_graph_coo.col], dtype=torch.long)
finish generating bi, ui graph
finish generating non-atom graph
U-B Train Epoch: 1 [2048/34416 (6%)]	Loss: 0.957698
Train Epoch: 1: time = 18s
Test: time=3s
Recall@20:0.14483697755226374	NDCG@20:0.06402821490876616	Precision@20:0.012047989378913345	Recall@40:0.2272300862025151	NDCG@40:0.08258376229490208	Precision@40:0.009327475788545753	Recall@80:0.327198968380035	NDCG@80:0.10193504856905046	Precision@80:0.006889996556020662	
Test: time=3s
Recall@20:0.1532680721611701	NDCG@20:0.07751687485932418	Precision@20:0.02189929068753267	Recall@40:0.23366876919956858	NDCG@40:0.09911253872091765	Precision@40:0.017387631536537267	Recall@80:0.33879511176673655	NDCG@80:0.12292504705420697	Precision@80:0.012964684723921425	
U-B Train Epoch: 2 [2048/34416 (6%)]	Loss: 0.698186
Train Epoch: 2: time = 11s
U-B Train Epoch: 3 [2048/34416 (6%)]	Loss: 0.565035
Train Epoch: 3: time = 11s
U-B Train Epoch: 4 [2048/34416 (6%)]	Loss: 0.501668
Train Epoch: 4: time = 11s
U-B Train Epoch: 5 [2048/34416 (6%)]	Loss: 0.466280
Train Epoch: 5: time = 11s
U-B Train Epoch: 6 [2048/34416 (6%)]	Loss: 0.393982
Train Epoch: 6: time = 9s
Test: time=3s
Recall@20:0.24026496992920168	NDCG@20:0.11650041359105034	Precision@20:0.01928016292601673	Recall@40:0.33483722218793566	NDCG@40:0.1384152937434984	Precision@40:0.013889828417985252	Recall@80:0.44558113513261977	NDCG@80:0.15990054281066501	Precision@80:0.009416188288073396	
Test: time=3s
Recall@20:0.24113924852212001	NDCG@20:0.13885720817975877	Precision@20:0.03496113706577787	Recall@40:0.3312188007010524	NDCG@40:0.16357620151593258	Precision@40:0.025092937447566282	Recall@80:0.45222665490875297	NDCG@80:0.19098495993915543	Precision@80:0.017446772880592876	
U-B Train Epoch: 7 [2048/34416 (6%)]	Loss: 0.336015
Train Epoch: 7: time = 9s
U-B Train Epoch: 8 [2048/34416 (6%)]	Loss: 0.339212
Train Epoch: 8: time = 9s
U-B Train Epoch: 9 [2048/34416 (6%)]	Loss: 0.293196
Train Epoch: 9: time = 10s
U-B Train Epoch: 10 [2048/34416 (6%)]	Loss: 0.241495
Train Epoch: 10: time = 10s
U-B Train Epoch: 11 [2048/34416 (6%)]	Loss: 0.238266
Train Epoch: 11: time = 9s
Test: time=3s
Recall@20:0.24422544303396418	NDCG@20:0.11876694452686058	Precision@20:0.019618114292238885	Recall@40:0.33871348059713213	NDCG@40:0.140686659121602	Precision@40:0.014084150437448185	Recall@80:0.4540275323628654	NDCG@80:0.16299074410828193	Precision@80:0.009585164293480629	
Test: time=3s
Recall@20:0.2441189254446181	NDCG@20:0.14051132743605974	Precision@20:0.035941197768221356	Recall@40:0.3465798169465112	NDCG@40:0.1679758276235175	Precision@40:0.02607299815000977	Recall@80:0.46110193807557454	NDCG@80:0.19432257123394728	Precision@80:0.017974822897490476	
U-B Train Epoch: 12 [2048/34416 (6%)]	Loss: 0.195051
Train Epoch: 12: time = 12s
U-B Train Epoch: 13 [2048/34416 (6%)]	Loss: 0.196220
Train Epoch: 13: time = 11s
U-B Train Epoch: 14 [2048/34416 (6%)]	Loss: 0.181189
Train Epoch: 14: time = 11s
U-B Train Epoch: 15 [2048/34416 (6%)]	Loss: 0.178144
Train Epoch: 15: time = 11s
U-B Train Epoch: 16 [2048/34416 (6%)]	Loss: 0.137175
Train Epoch: 16: time = 11s
Test: time=3s
Recall@20:0.24492589313059732	NDCG@20:0.11993381130248157	Precision@20:0.019466036596423913	Recall@40:0.3374222900143102	NDCG@40:0.14130042444495342	Precision@40:0.013805339448393177	Recall@80:0.44770809378564336	NDCG@80:0.1628820658455269	Precision@80:0.009433085791925274	
Test: time=3s
Recall@20:0.2319991977765134	NDCG@20:0.1328148411592546	Precision@20:0.033778305027927245	Recall@40:0.3283788713904481	NDCG@40:0.15898117111840335	Precision@40:0.0247211888175673	Recall@80:0.442373499430366	NDCG@80:0.18512787968776404	Precision@80:0.01719330919477818	
U-B Train Epoch: 17 [2048/34416 (6%)]	Loss: 0.142502
Train Epoch: 17: time = 11s
U-B Train Epoch: 18 [2048/34416 (6%)]	Loss: 0.120965
Train Epoch: 18: time = 11s
U-B Train Epoch: 19 [2048/34416 (6%)]	Loss: 0.117113
Train Epoch: 19: time = 11s
U-B Train Epoch: 20 [2048/34416 (6%)]	Loss: 0.103435
Train Epoch: 20: time = 11s
U-B Train Epoch: 21 [2048/34416 (6%)]	Loss: 0.091638
Train Epoch: 21: time = 11s
Test: time=3s
Recall@20:0.2345079922845292	NDCG@20:0.11704980219163859	Precision@20:0.01858736091709169	Recall@40:0.33098243128089094	NDCG@40:0.13934039972891232	Precision@40:0.013534978097578528	Recall@80:0.4386694863987517	NDCG@80:0.1603860574704886	Precision@80:0.009221865624018158	
Test: time=3s
Recall@20:0.236105962394258	NDCG@20:0.13382766584400874	Precision@20:0.033676920327112135	Recall@40:0.32799420448604893	NDCG@40:0.15867957669200428	Precision@40:0.024256505447289717	Recall@80:0.4382575145642795	NDCG@80:0.18440100130659376	Precision@80:0.016986312879102784	
U-B Train Epoch: 22 [2048/34416 (6%)]	Loss: 0.083320
Train Epoch: 22: time = 11s
U-B Train Epoch: 23 [2048/34416 (6%)]	Loss: 0.077608
Train Epoch: 23: time = 11s
U-B Train Epoch: 24 [2048/34416 (6%)]	Loss: 0.076107
Train Epoch: 24: time = 11s
U-B Train Epoch: 25 [2048/34416 (6%)]	Loss: 0.071421
Train Epoch: 25: time = 11s
U-B Train Epoch: 26 [2048/34416 (6%)]	Loss: 0.056731
Train Epoch: 26: time = 11s
Test: time=3s
Recall@20:0.21488584961267532	NDCG@20:0.10586794085823309	Precision@20:0.01691449820572317	Recall@40:0.3035769293379969	NDCG@40:0.12623574533104776	Precision@40:0.012318351052024147	Recall@80:0.40606381080165915	NDCG@80:0.14600777634095002	Precision@80:0.008410780765833827	
Test: time=3s
Recall@20:0.23612759491204008	NDCG@20:0.13175353024125946	Precision@20:0.0335924303906316	Recall@40:0.325242769963921	NDCG@40:0.15588170316179847	Precision@40:0.024036837413771082	Recall@80:0.4345786870432367	NDCG@80:0.1807920424347594	Precision@80:0.01657232218152891	
U-B Train Epoch: 27 [2048/34416 (6%)]	Loss: 0.051329
Train Epoch: 27: time = 11s
U-B Train Epoch: 28 [2048/34416 (6%)]	Loss: 0.046741
Train Epoch: 28: time = 11s
U-B Train Epoch: 29 [2048/34416 (6%)]	Loss: 0.042614
Train Epoch: 29: time = 11s
U-B Train Epoch: 30 [2048/34416 (6%)]	Loss: 0.031005
Train Epoch: 30: time = 11s
U-B Train Epoch: 31 [2048/34416 (6%)]	Loss: 0.035590
Train Epoch: 31: time = 10s
Test: time=3s
Recall@20:0.21243797165592526	NDCG@20:0.10500764733998104	Precision@20:0.016931395870723124	Recall@40:0.297968259491039	NDCG@40:0.12447683599278024	Precision@40:0.012081784708913253	Recall@80:0.39660599151951675	NDCG@80:0.14343842883172894	Precision@80:0.008169989925898907	
Test: time=3s
Recall@20:0.2247284801878934	NDCG@20:0.12319743887078484	Precision@20:0.031919567034670776	Recall@40:0.31861999140433583	NDCG@40:0.14859217121295729	Precision@40:0.023504562738901377	Recall@80:0.42461021657971443	NDCG@80:0.17271741510605884	Precision@80:0.016213248170038542	
U-B Train Epoch: 32 [2048/34416 (6%)]	Loss: 0.023597
Train Epoch: 32: time = 10s
U-B Train Epoch: 33 [2048/34416 (6%)]	Loss: 0.018131
Train Epoch: 33: time = 9s
U-B Train Epoch: 34 [2048/34416 (6%)]	Loss: 0.027773
Train Epoch: 34: time = 10s
U-B Train Epoch: 35 [2048/34416 (6%)]	Loss: 0.016246
Train Epoch: 35: time = 9s
U-B Train Epoch: 36 [2048/34416 (6%)]	Loss: 0.019186
Train Epoch: 36: time = 10s
Test: time=3s
Recall@20:0.20070112150397887	NDCG@20:0.0988213016036879	Precision@20:0.016035823493279408	Recall@40:0.2825320373720799	NDCG@40:0.11741583006492375	Precision@40:0.011431227345932332	Recall@80:0.3751538255078521	NDCG@80:0.13537385714299857	Precision@80:0.00776867191305673	
Test: time=3s
Recall@20:0.21310786292052583	NDCG@20:0.11544660314912529	Precision@20:0.030060832908968136	Recall@40:0.2965729027916024	NDCG@40:0.1382052262677821	Precision@40:0.021823251033884803	Recall@80:0.3929663448971887	NDCG@80:0.16031530701900584	Precision@80:0.014933254477864144	
U-B Train Epoch: 37 [2048/34416 (6%)]	Loss: -0.008826
Train Epoch: 37: time = 11s
U-B Train Epoch: 38 [2048/34416 (6%)]	Loss: 0.000133
Train Epoch: 38: time = 11s
U-B Train Epoch: 39 [2048/34416 (6%)]	Loss: -0.016963
Train Epoch: 39: time = 11s
U-B Train Epoch: 40 [2048/34416 (6%)]	Loss: -0.003600
Train Epoch: 40: time = 11s
U-B Train Epoch: 41 [2048/34416 (6%)]	Loss: -0.030035
Train Epoch: 41: time = 11s
Test: time=3s
Recall@20:0.20189896996418502	NDCG@20:0.09829088206547425	Precision@20:0.015816154170576163	Recall@40:0.27775444812007594	NDCG@40:0.1159552380457727	Precision@40:0.011329841517080686	Recall@80:0.37153759563480854	NDCG@80:0.13405928848643042	Precision@80:0.0077222035760289715	
Test: time=3s
Recall@20:0.20454833716224602	NDCG@20:0.11139329070374546	Precision@20:0.029199053605451258	Recall@40:0.2853349155169478	NDCG@40:0.13319087826186396	Precision@40:0.02095302467049679	Recall@80:0.37817200263959	NDCG@80:0.15445384611830432	Precision@80:0.014329165129614827	
U-B Train Epoch: 42 [2048/34416 (6%)]	Loss: -0.030875
Train Epoch: 42: time = 12s
U-B Train Epoch: 43 [2048/34416 (6%)]	Loss: -0.044816
Train Epoch: 43: time = 12s
U-B Train Epoch: 44 [2048/34416 (6%)]	Loss: -0.042926
Train Epoch: 44: time = 12s
U-B Train Epoch: 45 [2048/34416 (6%)]	Loss: -0.045367
Train Epoch: 45: time = 11s
U-B Train Epoch: 46 [2048/34416 (6%)]	Loss: -0.045903
Train Epoch: 46: time = 12s
Test: time=3s
Recall@20:0.18639743775280396	NDCG@20:0.08997318671337048	Precision@20:0.014971273821243847	Recall@40:0.2565134969584319	NDCG@40:0.106124421558335	Precision@40:0.010535654001600156	Recall@80:0.3527851420586558	NDCG@80:0.12452951723274729	Precision@80:0.007329334556834848	
Test: time=3s
Recall@20:0.18673076932597055	NDCG@20:0.10230767706754684	Precision@20:0.026884083491638327	Recall@40:0.2671909673909313	NDCG@40:0.12373680535020277	Precision@40:0.019584319606831282	Recall@80:0.35622883777676423	NDCG@80:0.14430280648683044	Precision@80:0.013636363765282097	
U-B Train Epoch: 47 [2048/34416 (6%)]	Loss: -0.067746
Train Epoch: 47: time = 11s
U-B Train Epoch: 48 [2048/34416 (6%)]	Loss: -0.068879
Train Epoch: 48: time = 11s
U-B Train Epoch: 49 [2048/34416 (6%)]	Loss: -0.073816
Train Epoch: 49: time = 11s
U-B Train Epoch: 50 [2048/34416 (6%)]	Loss: -0.079705
Train Epoch: 50: time = 11s
U-B Train Epoch: 51 [2048/34416 (6%)]	Loss: -0.076671
Train Epoch: 51: time = 11s
Test: time=3s
Recall@20:0.16340556246237645	NDCG@20:0.08129065469456268	Precision@20:0.01331530974176374	Recall@40:0.2246198070818768	NDCG@40:0.09554606363877287	Precision@40:0.009496451310508757	Recall@80:0.3147285309301997	NDCG@80:0.112836728832455	Precision@80:0.006678776871557774	
Test: time=3s
Recall@20:0.18854674571025368	NDCG@20:0.10209898128425725	Precision@20:0.026732004828934897	Recall@40:0.2695863652205137	NDCG@40:0.1241209307970651	Precision@40:0.01995606630305335	Recall@80:0.3544816883805234	NDCG@80:0.14394467615847573	Precision@80:0.01378421841460573	
U-B Train Epoch: 52 [2048/34416 (6%)]	Loss: -0.070994
Train Epoch: 52: time = 11s
U-B Train Epoch: 53 [2048/34416 (6%)]	Loss: -0.118361
Train Epoch: 53: time = 12s
U-B Train Epoch: 54 [2048/34416 (6%)]	Loss: -0.098983
Train Epoch: 54: time = 11s
U-B Train Epoch: 55 [2048/34416 (6%)]	Loss: -0.089362
Train Epoch: 55: time = 11s
U-B Train Epoch: 56 [2048/34416 (6%)]	Loss: -0.105878
Train Epoch: 56: time = 10s
Test: time=3s
Recall@20:0.1661757030532182	NDCG@20:0.08309678944352109	Precision@20:0.013585671092578388	Recall@40:0.2306625763279798	NDCG@40:0.09788739048737696	Precision@40:0.009606285810712304	Recall@80:0.31926661546506685	NDCG@80:0.11508178195263655	Precision@80:0.006788611210613245	
Test: time=3s
Recall@20:0.1793585284491897	NDCG@20:0.09856587287822903	Precision@20:0.026208179470009398	Recall@40:0.2602721765743151	NDCG@40:0.12020215765774835	Precision@40:0.019305508617776277	Recall@80:0.34517347639418405	NDCG@80:0.14006719560226744	Precision@80:0.01342514408081921	
U-B Train Epoch: 57 [2048/34416 (6%)]	Loss: -0.116980
Train Epoch: 57: time = 10s
U-B Train Epoch: 58 [2048/34416 (6%)]	Loss: -0.124637
Train Epoch: 58: time = 10s
U-B Train Epoch: 59 [2048/34416 (6%)]	Loss: -0.134439
Train Epoch: 59: time = 9s
U-B Train Epoch: 60 [2048/34416 (6%)]	Loss: -0.153572
Train Epoch: 60: time = 9s
U-B Train Epoch: 61 [2048/34416 (6%)]	Loss: -0.154683
Train Epoch: 61: time = 9s
Test: time=3s
Recall@20:0.15071680675531085	NDCG@20:0.07652564014925994	Precision@20:0.012267658379320439	Recall@40:0.21381713619664056	NDCG@40:0.09125645912430826	Precision@40:0.008997972449083189	Recall@80:0.297130892831919	NDCG@80:0.10759517750896365	Precision@80:0.006446434702974753	
Test: time=3s
Recall@20:0.1622888913787914	NDCG@20:0.09108090569901281	Precision@20:0.024062184717011395	Recall@40:0.2330471707905173	NDCG@40:0.11037594098100473	Precision@40:0.01783541756411105	Recall@80:0.319588086539807	NDCG@80:0.13049730750184158	Precision@80:0.012681649721486618	
U-B Train Epoch: 62 [2048/34416 (6%)]	Loss: -0.144073
Train Epoch: 62: time = 11s
U-B Train Epoch: 63 [2048/34416 (6%)]	Loss: -0.184170
Train Epoch: 63: time = 12s
U-B Train Epoch: 64 [2048/34416 (6%)]	Loss: -0.177396
Train Epoch: 64: time = 11s
U-B Train Epoch: 65 [2048/34416 (6%)]	Loss: -0.206221
Train Epoch: 65: time = 11s
U-B Train Epoch: 66 [2048/34416 (6%)]	Loss: -0.174312
Train Epoch: 66: time = 11s
Test: time=3s
Recall@20:0.15225797539105404	NDCG@20:0.07683392415460842	Precision@20:0.012335248394727948	Recall@40:0.2129150009026355	NDCG@40:0.09104006175214917	Precision@40:0.008997972610231266	Recall@80:0.2897327006689074	NDCG@80:0.10611728721069459	Precision@80:0.006328151531419306	
Test: time=3s
Recall@20:0.15629921591173115	NDCG@20:0.08935145680748881	Precision@20:0.023791822077012133	Recall@40:0.2241522456069539	NDCG@40:0.10763352301605009	Precision@40:0.017336938541537405	Recall@80:0.3059894269122671	NDCG@80:0.12682257700949434	Precision@80:0.01227188271499639	
U-B Train Epoch: 67 [2048/34416 (6%)]	Loss: -0.195471
Train Epoch: 67: time = 12s
U-B Train Epoch: 68 [2048/34416 (6%)]	Loss: -0.212339
Train Epoch: 68: time = 12s
U-B Train Epoch: 69 [2048/34416 (6%)]	Loss: -0.219684
Train Epoch: 69: time = 12s
U-B Train Epoch: 70 [2048/34416 (6%)]	Loss: -0.204739
Train Epoch: 70: time = 11s
U-B Train Epoch: 71 [2048/34416 (6%)]	Loss: -0.263686
Train Epoch: 71: time = 11s
Test: time=3s
Recall@20:0.14730832124731355	NDCG@20:0.07479103967602811	Precision@20:0.012284555399728087	Recall@40:0.21012689165667772	NDCG@40:0.08920436857841675	Precision@40:0.008888137948879642	Recall@80:0.2877521830742808	NDCG@80:0.104547872540112	Precision@80:0.0063197026989193295	
Test: time=3s
Recall@20:0.15629031022443446	NDCG@20:0.0889759379570933	Precision@20:0.023504562738901377	Recall@40:0.22252046276323292	NDCG@40:0.10720612995525436	Precision@40:0.017412977550592967	Recall@80:0.30432287733794144	NDCG@80:0.12602870486079942	Precision@80:0.01222541437796863	
U-B Train Epoch: 72 [2048/34416 (6%)]	Loss: -0.256893
Train Epoch: 72: time = 12s
U-B Train Epoch: 73 [2048/34416 (6%)]	Loss: -0.233911
Train Epoch: 73: time = 11s
U-B Train Epoch: 74 [2048/34416 (6%)]	Loss: -0.272320
Train Epoch: 74: time = 11s
U-B Train Epoch: 75 [2048/34416 (6%)]	Loss: -0.242633
Train Epoch: 75: time = 11s
U-B Train Epoch: 76 [2048/34416 (6%)]	Loss: -0.238755
Train Epoch: 76: time = 12s
Test: time=3s
Recall@20:0.1445541433403322	NDCG@20:0.07314799967227896	Precision@20:0.012031091713913393	Recall@40:0.20032871216686646	NDCG@40:0.0862344056619668	Precision@40:0.00861777627576884	Recall@80:0.2806660560950833	NDCG@80:0.10205609526896887	Precision@80:0.006209868198715782	
Test: time=3s
Recall@20:0.1487454397930572	NDCG@20:0.08476045253350148	Precision@20:0.022710376029161233	Recall@40:0.21056260511495647	NDCG@40:0.10151680614062764	Precision@40:0.016500507185853143	Recall@80:0.2863850337341453	NDCG@80:0.11937026745485832	Precision@80:0.011676242360395127	
U-B Train Epoch: 77 [2048/34416 (6%)]	Loss: -0.258365
Train Epoch: 77: time = 11s
U-B Train Epoch: 78 [2048/34416 (6%)]	Loss: -0.225903
Train Epoch: 78: time = 11s
U-B Train Epoch: 79 [2048/34416 (6%)]	Loss: -0.326477
Train Epoch: 79: time = 12s
U-B Train Epoch: 80 [2048/34416 (6%)]	Loss: -0.262853
Train Epoch: 80: time = 11s
U-B Train Epoch: 81 [2048/34416 (6%)]	Loss: -0.337121
Train Epoch: 81: time = 11s
Test: time=3s
Recall@20:0.1420769029148691	NDCG@20:0.07271469054330076	Precision@20:0.011828320700802405	Recall@40:0.1987375128547176	NDCG@40:0.08588441911280337	Precision@40:0.008550185776917102	Recall@80:0.2732973604759843	NDCG@80:0.10077066218462213	Precision@80:0.006142278183308273	
Test: time=3s
Recall@20:0.1354474438006268	NDCG@20:0.08024038048602714	Precision@20:0.021797904375236796	Recall@40:0.19931356179307305	NDCG@40:0.09737887935245226	Precision@40:0.016002027518687196	Recall@80:0.27564516160970765	NDCG@80:0.11536619412653266	Precision@80:0.011435451520460205	
